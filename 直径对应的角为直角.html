<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³°å‹’æ–¯å®šç†åŠåœ†æ¼”ç¤º</title>
    <!-- Common Libraries -->
    <script src="https://cdn.geogebra.org/apps/deployggb.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Link to common stylesheet -->
    <link rel="stylesheet" href="style.css">
    <!-- Page-specific styles -->
    <style>
        /* Specific layout for this page */
        .thales-layout {
            display: flex;
            gap: 1.5rem; /* Use gap from common styles */
        }
        .left-panel-thales {
            flex: 2; /* Adjust flex ratio if needed */
            min-width: 500px; /* Keep min-width */
        }
        .right-panel-thales {
            flex: 1;
            min-width: 300px;
            display: flex; /* Keep flex column layout */
            flex-direction: column;
            gap: 1.5rem; /* Keep gap */
        }

        /* Specific styles for elements within panels */
        .left-panel-thales h1 { /* Keep specific h1 style */
            color: var(--dark-color);
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        /* Style the specific info boxes */
        .theorem-box, .instructions-box, .properties-box {
             padding: 15px;
             border-radius: 8px;
             border: 1px solid var(--border-color);
             background-color: var(--card-bg); /* Use card background */
        }
        .theorem-box { /* Specific background */
             background-color: #e8f4fc;
        }
         .instructions-box { /* Specific border */
             border-left: 4px solid var(--secondary-color);
         }

        .theorem-box h2, .instructions-box h3, .properties-box h3 {
             margin-bottom: 0.5rem;
             font-size: 1.2rem;
        }
         .theorem-box h2 { color: var(--primary-color); }
         .instructions-box h3 { color: var(--secondary-color); }
         .properties-box h3 { color: var(--accent-color); }

        .property-item { /* Style property items */
            margin: 10px 0;
            padding: 8px 12px;
            background-color: var(--light-color);
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }

        .animation-controls { /* Style animation controls */
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* Ensure ggb-container uses common style */
        #ggb-container {
             /* Inherits from .ggb-container in style.css */
             /* Override height if needed */
             height: 500px;
        }

        /* Responsive adjustments specific to this layout */
        @media (max-width: 900px) {
            .thales-layout {
                flex-direction: column;
            }
            .left-panel-thales, .right-panel-thales {
                min-width: 100%;
            }
            #ggb-container {
                height: 400px; /* Adjust height for smaller screens */
            }
        }
    </style>
</head>

<body>
    <div class="header">
        <h1><i class="fas fa-drafting-compass"></i> æ³°å‹’æ–¯å®šç†åŠåœ†æ¼”ç¤º</h1>
        <p>ç›´å¾„æ‰€å¯¹çš„åœ†å‘¨è§’æ’ä¸ºç›´è§’</p>
    </div>
    <!-- Use main-content-area for centering/padding -->
    <main class="main-content-area">
        <!-- Add specific layout class -->
        <div class="thales-layout">
            <!-- Add 'card' class and specific panel class -->
            <div class="left-panel-thales card">
                <h1>æ³°å‹’æ–¯å®šç†åŠåœ†æ¼”ç¤º</h1>
                <!-- Add 'ggb-container' class -->
                <div id="ggb-container" class="ggb-container"></div>
            </div>

            <!-- Add 'card' class and specific panel class -->
            <div class="right-panel-thales card">
                <!-- Add specific box class -->
                <div class="theorem-box">
                    <h2>æ³°å‹’æ–¯å®šç†</h2>
                    <p><strong>å®šç†å†…å®¹ï¼š</strong>ç›´å¾„æ‰€å¯¹çš„åœ†å‘¨è§’æ’ä¸ºç›´è§’ã€‚</p>
                    <p>æœ¬æ¼”ç¤ºä¸­ï¼š</p>
                    <ul>
                        <li>ABä¸ºåœ†çš„ç›´å¾„</li>
                        <li>Cä¸ºåŠåœ†ä¸Šçš„åŠ¨ç‚¹</li>
                        <li>æ— è®ºCå¦‚ä½•ç§»åŠ¨ï¼Œâˆ ACBå§‹ç»ˆä¸º90Â°</li>
                    </ul>
                </div>

                <!-- Add specific box class -->
                <div class="instructions-box">
                    <h3>æ“ä½œè¯´æ˜</h3>
                    <p>1. æ‹–åŠ¨ç‚¹Cè§‚å¯Ÿè§’åº¦å˜åŒ–ï¼ˆç‚¹Cåªèƒ½æ²¿åŠåœ†ç§»åŠ¨ï¼‰</p>
                    <p>2. ä½¿ç”¨ä¸‹æ–¹æŒ‰é’®æ§åˆ¶ç‚¹Cçš„è‡ªåŠ¨ç§»åŠ¨</p>

                    <div class="animation-controls">
                        <!-- Buttons already have .btn class -->
                        <button id="playBtn" class="btn btn-play" onclick="startAnimation()">â–¶ æ’­æ”¾</button>
                        <button id="pauseBtn" class="btn btn-pause" onclick="pauseAnimation()" disabled>â¸ æš‚åœ</button>
                        <button id="resetBtn" class="btn" onclick="resetView()">â†» é‡ç½®</button>
                    </div>
                </div>

                <!-- Add specific box class -->
                <div class="properties-box">
                    <h3>å®æ—¶å±æ€§</h3>
                    <div class="property-item" id="angle-display">âˆ ACB: 90Â°</div>
                    <div class="property-item" id="point-position">ç‚¹Cåæ ‡: (0, 3)</div>
                    <div class="property-item" id="animation-status">åŠ¨ç”»çŠ¶æ€: åœæ­¢</div>
                </div>
            </div>
        </div>
    </main>

    <script>


        // åˆå§‹åŒ–GeoGebra
        var applet = new GGBApplet({
            "width": "700",
            "height": "500",
            "appName": "classic",
            "showToolBar": false,
            "showMenuBar": false,
            "showAlgebraInput": false,
            "showZoomButtons": false,
            "enableRightClick": false,
            "allowStyleBar": false,
            "enableShiftDragZoom": true, // ä¿ç•™ç¼©æ”¾åŠŸèƒ½
            "borderColor": null,         // æ— è¾¹æ¡†
            "language": "zh",
            "appletOnLoad": function (api) {
                window.ggbApp = api;
                initializeScene();
                startUpdatingProperties();
            },
            "language": "zh"
        }, true);
        //applet.setHTML5Codebase('./HTML5/5.0/web3d/');
        window.addEventListener("load", function () {
            applet.inject('ggb-container');
        });

        function initializeScene() {
            if (!ggbApp) return;
            ggbApp.reset();
            ggbApp.evalCommand('SetPerspective("-A")');
            // è®¾ç½®åˆå§‹è§†å›¾
            ggbApp.evalCommand("A=(-3,0)");
            ggbApp.evalCommand("B=(3,0)");
            ggbApp.evalCommand("s=Semicircle(A,B)");
            ggbApp.evalCommand("C=Point(s)");
            ggbApp.evalCommand("a=Segment(A,C)");
            ggbApp.evalCommand("b=Segment(B,C)");
            ggbApp.evalCommand("SetDynamicColor(a,1,0,0)");
            ggbApp.evalCommand("SetDynamicColor(b,0,0,1)");
            ggbApp.evalCommand("angle=Angle(A,C,B)");
            ggbApp.evalCommand("ShowLabel(C,true)");
            ggbApp.evalCommand("SetConditionToShowObject(angle,true)");
            // ---- åˆ›å»ºæŒ‰é’® -------------------------------------------------
            // è¿™é‡Œç›´æ¥ç”¨ GeoGebra å‘½ä»¤åˆ›å»ºä¸€ä¸ªæŒ‰é’®å¯¹è±¡
            ggbApp.evalCommand('startButton = Button("å¼€å§‹")');
            ggbApp.setFixed("startButton", false);
            ggbApp.evalCommand('stopButton = Button("åœæ­¢")');
            ggbApplet.setCorner("stopButton", 100, 100);
            ggbApp.setFixed("stopButton", false);
            // ---- æ³¨å†Œç‚¹å‡»ç›‘å¬å™¨ -----------------------------------------
            window.ggbApp.registerObjectClickListener('startButton', function (objName) {
                console.log('ğŸ”˜ æŒ‰é’®è¢«ç‚¹å‡»:', objName);
                startAnimation()
            });
            // ---- æ³¨å†Œç‚¹å‡»ç›‘å¬å™¨ -----------------------------------------
            window.ggbApp.registerObjectClickListener('stopButton', function (objName) {
                console.log('ğŸ”˜ æŒ‰é’®è¢«ç‚¹å‡»:', objName);
                pauseAnimation()
            });

            // ï¼ˆå¯é€‰ï¼‰åœ¨ç”»å¸ƒä¸‹æ–¹æ”¾ä¸€æ®µè¯´æ˜æ–‡å­—
            ggbApp.evalCommand('Info = Text("ç‚¹å‡»æŒ‰é’®ç”Ÿæˆä¸¤éšæœºç‚¹å¹¶è¿çº¿", (0, -1))');
            ggbApp.setFixed("Info", false)
        }

        function resetView() {
            pauseAnimation();
            if (ggbApp) {
                ggbApp.reset();
                initializeScene();
            }
            updateAnimationStatus("åœæ­¢");
        }

        // å¼€å§‹åŠ¨ç”»
        function startAnimation() {
            if (!ggbApp) return;

            // å¯ç”¨/ç¦ç”¨æŒ‰é’®
            document.getElementById("playBtn").disabled = true;
            document.getElementById("pauseBtn").disabled = false;

            updateAnimationStatus("æ’­æ”¾ä¸­");

            // åˆ›å»ºåŠ¨ç”»å¾ªç¯
            ggbApp.setAnimating("C", true);
            ggbApp.startAnimation();
        }

        // æš‚åœåŠ¨ç”»
        function pauseAnimation() {
            if (ggbApp.isAnimationRunning()) {
                ggbApp.stopAnimation();


                // å¯ç”¨/ç¦ç”¨æŒ‰é’®
                document.getElementById("playBtn").disabled = false;
                document.getElementById("pauseBtn").disabled = true;

                updateAnimationStatus("å·²æš‚åœ");

            }
        }

        // æ›´æ–°å®æ—¶å±æ€§
        function updateProperties() {
            if (!window.ggbApp) return;

            try {
                const angle = ggbApp.getValue("angle");
                const cx = ggbApp.getXcoord("C");
                const cy = ggbApp.getYcoord("C");

                const pi = Math.PI;
                document.getElementById("angle-display").textContent = `âˆ ACB: ${(angle/pi*180).toFixed(0)}Â°`;
                document.getElementById("point-position").textContent = `ç‚¹Cåæ ‡: (${cx.toFixed(2)}, ${cy.toFixed(2)})`;
            } catch (e) {
                console.error("æ›´æ–°å±æ€§æ—¶å‡ºé”™:", e);
            }
        }

        // æ›´æ–°åŠ¨ç”»çŠ¶æ€æ˜¾ç¤º
        function updateAnimationStatus(status) {
            document.getElementById("animation-status").textContent = `åŠ¨ç”»çŠ¶æ€: ${status}`;
        }

        // å¼€å§‹å®šæœŸæ›´æ–°å±æ€§
        function startUpdatingProperties() {
            updateProperties();
            setInterval(updateProperties, 500);
        }

    </script>
</body>

</html>
